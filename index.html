<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Intconp</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Intconp">
<meta property="og:url" content="https://warrenwx.github.io/index.html">
<meta property="og:site_name" content="Intconp">
<meta property="og:locale" content="En">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Intconp">
  
    <link rel="alternate" href="/atom.xml" title="Intconp" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Intconp</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">record and share</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://warrenwx.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-The-Essence-of-Life" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/04/19/The-Essence-of-Life/" class="article-date">
  <time datetime="2019-04-18T18:08:20.000Z" itemprop="datePublished">2019-04-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/04/19/The-Essence-of-Life/">The Essence of Life</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://warrenwx.github.io/2019/04/19/The-Essence-of-Life/" data-id="cjumisvga000eqtpvj811dvj7" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Nginx-luajit-memory-crash-mmap-wrapper" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/04/01/Nginx-luajit-memory-crash-mmap-wrapper/" class="article-date">
  <time datetime="2019-04-01T11:19:55.000Z" itemprop="datePublished">2019-04-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/04/01/Nginx-luajit-memory-crash-mmap-wrapper/">Nginx luajit memory crash mmap_wrapper</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h3><p>Nginx plays an import role in internet trade. But recently, a problem comes out. a Nginx worker process occupy a cpu core fully, nearly 100 percent, and it used nearly 1G Bytes memory, so that the lua vm crashed. Becuase in x86-64 architecure, lua jit can only use 1 Bytes mem.</p>
<p>Nginx standard errlog:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx: lua atpanic: Lua VM crashed, reason: not enough memory</span><br></pre></td></tr></table></figure></p>
<h3 id="Causes"><a href="#Causes" class="headerlink" title="Causes"></a>Causes</h3><p>The Nginx accept many big request with big body, then the lua scripts run with long time on string joint and split, while luajit works bad on this scene, which lead to our problem.</p>
<h3 id="Solutions"><a href="#Solutions" class="headerlink" title="Solutions"></a>Solutions</h3><p>Discard these big requests.<br>Make luajit use more memory.<br>According to our pratical use scnario, I choose the second way. Finally, My nignx worker can use 4G Bytes memory. Steps as follow:</p>
<p>Get mmap from <a href="https://github.com/Neopallium/mmap_lowmem" target="_blank" rel="noopener">https://github.com/Neopallium/mmap_lowmem</a>.<br>Compile and link mmap_wrapper, we got libmmap_lowmem_mt.so.<br>Get openresty from <a href="https://github.com/openresty/openresty/releases" target="_blank" rel="noopener">https://github.com/openresty/openresty/releases</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./configure ?with-ld-opt=?/opt/mmap_lowmem/libmmap_lowmem_mt.so? -j8</span><br></pre></td></tr></table></figure></p>
<p>Notes:<br>In step 4, we may meet compile interrupt, like openssl zlib pcre missing, just fix it, finally, openresty installment wil finish.</p>
<p>Run ./nginx, some hint comes out, like ?? got low-mem: len=0xfe3b6000, start=0x1c4a000, end=0x100000000?<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl 127.0.0.1/mem_test</span><br><span class="line">Mem used:2863.9989748001 M</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://warrenwx.github.io/2019/04/01/Nginx-luajit-memory-crash-mmap-wrapper/" data-id="cjumisvel000cqtpvuyccl5py" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Linux-Mem-High-Go-Trouble-Shooting" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/03/Linux-Mem-High-Go-Trouble-Shooting/" class="article-date">
  <time datetime="2018-11-02T17:50:59.000Z" itemprop="datePublished">2018-11-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/03/Linux-Mem-High-Go-Trouble-Shooting/">Linux-Mem-High-Go-Trouble-Shooting</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://raw.githubusercontent.com/warrenwx/hexo_data/master/files/20181102/1.png" alt="image1"></p>
<p>memory rise up to 90%, process was killed.</p>
<p><img src="https://raw.githubusercontent.com/warrenwx/hexo_data/master/files/20181102/2.png" alt="image1"></p>
<p>the incoming throughput is normal, at 00:00</p>
<p><img src="https://raw.githubusercontent.com/warrenwx/hexo_data/master/files/20181102/3.png" alt="image1"></p>
<p>the outcoming throughput rise abruptly, which last 4 mins (23:59 – 00:03). I think it is an occasion that concurrent files uploading.</p>
<p><img src="https://raw.githubusercontent.com/warrenwx/hexo_data/master/files/20181102/4.png" alt="image1"></p>
<p>establish tcp connections, which last 8 mins (23:59 – 00:07)</p>
<p><img src="https://raw.githubusercontent.com/warrenwx/hexo_data/master/files/20181102/5.png" alt="image1"></p>
<p>close connections by itself, which last 4 mins (23:59 – 00:03)</p>
<p><img src="https://raw.githubusercontent.com/warrenwx/hexo_data/master/files/20181102/6.png" alt="image1"></p>
<p>analysis: at the beginning of 23:59:00, 7.6k connections will be generated. At 00:00, connections start to become closed. 00:03:00 half of the connections were fully released</p>
<p>The problem was occured after repairing a high concurrency scene problem, which the concurrent control was used to solve the problem of  high memory. The above is the system status of the problem.</p>
<p>conclusion: concurrency control is not achieved, 7.6 K connection last for 1 minutes is not the expected phenomenon, the next step is walkthrough the golang code.</p>
<p>It is found that when the go program processes the concurrency with the channel, the asynchronous func is used between the produce and consume procudure, so that the consumption and return resource back is so quick, and the purpose of controlling concurrency cannot be achieved.</p>
<p>Modification method: return the space after the product is actually consumed.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://warrenwx.github.io/2018/11/03/Linux-Mem-High-Go-Trouble-Shooting/" data-id="cjumisvgi000iqtpvscuu1nxf" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-ios11-ppt" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/10/31/ios11-ppt/" class="article-date">
  <time datetime="2018-10-31T09:53:45.000Z" itemprop="datePublished">2018-10-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/31/ios11-ppt/">ios11-ppt</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="http://podcasts.apple.com/stanford/media/Lecture_1_Slides.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/Lecture_1_Slides.pdf</a><br><a href="http://podcasts.apple.com/stanford/media/Lecture_2_Slides.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/Lecture_2_Slides.pdf</a><br><a href="http://podcasts.apple.com/stanford/media/Lecture_3_Slides.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/Lecture_3_Slides.pdf</a><br><a href="http://podcasts.apple.com/stanford/media/Lecture_4_Slides.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/Lecture_4_Slides.pdf</a><br><a href="http://podcasts.apple.com/stanford/media/Lecture_5_Slides.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/Lecture_5_Slides.pdf</a><br><a href="http://podcasts.apple.com/stanford/media/Lecture_6_Slides.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/Lecture_6_Slides.pdf</a></p>
<p><a href="http://podcasts.apple.com/stanford/Programming_Project_1_Concentration.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/Programming_Project_1_Concentration.pdf</a><br><a href="http://podcasts.apple.com/stanford/Programming_Project%202_Set.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/Programming_Project%202_Set.pdf</a></p>
<p><a href="http://podcasts.apple.com/stanford/media/Reading_1_Intro_to_Swift.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/Reading_1_Intro_to_Swift.pdf</a><br><a href="http://podcasts.apple.com/stanford/media/Reading_2_Intro_to_Swift.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/Reading_2_Intro_to_Swift.pdf</a></p>
<p><a href="http://podcasts.apple.com/stanford/media/336-3367719085568248138-CS193P_F17_Reading_3.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/336-3367719085568248138-CS193P_F17_Reading_3.pdf</a><br><a href="http://podcasts.apple.com/stanford/media/309-1475895300459033080-CS193P_F17_Assignment_3.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/309-1475895300459033080-CS193P_F17_Assignment_3.pdf</a><br><a href="http://podcasts.apple.com/stanford/media/309-2441628197055099936-CS193P_F17_Assignment_4.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/309-2441628197055099936-CS193P_F17_Assignment_4.pdf</a><br><a href="http://podcasts.apple.com/stanford/media/308-8518403617003934463-CS193P_F17_Assignment_5.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/308-8518403617003934463-CS193P_F17_Assignment_5.pdf</a><br><a href="http://podcasts.apple.com/stanford/media/307-9138746427331321981-CS193P_F17_Assignment_6.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/307-9138746427331321981-CS193P_F17_Assignment_6.pdf</a><br><a href="http://podcasts.apple.com/stanford/media/320-5503734535583450465-CS193P_F17_Lecture_7.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/320-5503734535583450465-CS193P_F17_Lecture_7.pdf</a><br><a href="http://podcasts.apple.com/stanford/media/335-3416648937156657194-CS193P_F17_Lecture_8.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/335-3416648937156657194-CS193P_F17_Lecture_8.pdf</a><br><a href="http://podcasts.apple.com/stanford/media/332-3154341613995510587-CS193P_F17_Lecture_9.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/332-3154341613995510587-CS193P_F17_Lecture_9.pdf</a><br><a href="http://podcasts.apple.com/stanford/media/322-6515997048783028736-CS193P_F17_Lecture_10.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/322-6515997048783028736-CS193P_F17_Lecture_10.pdf</a><br><a href="http://podcasts.apple.com/stanford/media/317-8823617114003497609-CS193P_F17_Lecture_11.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/317-8823617114003497609-CS193P_F17_Lecture_11.pdf</a><br><a href="http://podcasts.apple.com/stanford/media/306-4082649130340532415-CS193P_F17_Lecture_12.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/306-4082649130340532415-CS193P_F17_Lecture_12.pdf</a><br><a href="http://podcasts.apple.com/stanford/media/323-4247208383177102782-CS193P_F17_Lecture_13.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/323-4247208383177102782-CS193P_F17_Lecture_13.pdf</a><br><a href="http://podcasts.apple.com/stanford/media/322-5794459892624250293-CS193P_F17_Lecture_14.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/322-5794459892624250293-CS193P_F17_Lecture_14.pdf</a><br><a href="http://podcasts.apple.com/stanford/media/522-830176750758320683-CS193P_F17_Lecture_15.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/522-830176750758320683-CS193P_F17_Lecture_15.pdf</a><br><a href="http://podcasts.apple.com/stanford/media/512-802352814004650525-CS193P_F17_Lecture_16.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/512-802352814004650525-CS193P_F17_Lecture_16.pdf</a><br><a href="http://podcasts.apple.com/stanford/media/520-5280642336803569160-CS193P_F17_Lecture_17_Slides.pdf" target="_blank" rel="noopener">http://podcasts.apple.com/stanford/media/520-5280642336803569160-CS193P_F17_Lecture_17_Slides.pdf</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://warrenwx.github.io/2018/10/31/ios11-ppt/" data-id="cjumisvk5000kqtpv1ajms83b" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ios11-ppt-open/">ios11, ppt, open.</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Access-restriction-The-type-Unsafe-is-not-API-restriction" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/10/25/Access-restriction-The-type-Unsafe-is-not-API-restriction/" class="article-date">
  <time datetime="2018-10-25T15:28:23.000Z" itemprop="datePublished">2018-10-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/25/Access-restriction-The-type-Unsafe-is-not-API-restriction/">Access restriction: The type Unsafe is not API (restriction</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Access-restriction-The-type-xxx-is-not-API-restriction"><a href="#Access-restriction-The-type-xxx-is-not-API-restriction" class="headerlink" title="Access restriction: The type xxx is not API (restriction"></a>Access restriction: The type xxx is not API (restriction</h3><p>Generally, we can see this in eclipse, as visit a non-public API is forbidden, such as sun.misc.Unsafe. Here I want to cancel this check temporarily.<br>steps as follow:</p>
<h4 id="step1-find-project-properties-and-click-on-‘build-path’"><a href="#step1-find-project-properties-and-click-on-‘build-path’" class="headerlink" title="step1. find project properties, and click on ‘build path’"></a>step1. find project properties, and click on ‘build path’</h4><p>[<img src="https://raw.githubusercontent.com/warrenwx/hexo_data/master/files/%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20181025153958.png" alt=""></p>
<h4 id="step2-double-click-‘Access-rules’-or-just-edit-it"><a href="#step2-double-click-‘Access-rules’-or-just-edit-it" class="headerlink" title="step2. double click ‘Access rules’ or just edit it"></a>step2. double click ‘Access rules’ or just edit it</h4><p>[<img src="https://raw.githubusercontent.com/warrenwx/hexo_data/master/files/%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20181025154023.png" alt=""></p>
<h4 id="step3-add-a-‘rule’-fill-blanks-like-this-project-rebuild"><a href="#step3-add-a-‘rule’-fill-blanks-like-this-project-rebuild" class="headerlink" title="step3. add a ‘rule’, fill blanks like this. project rebuild."></a>step3. add a ‘rule’, fill blanks like this. project rebuild.</h4><p>[<img src="https://raw.githubusercontent.com/warrenwx/hexo_data/master/files/%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20181025154219.png" alt=""></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://warrenwx.github.io/2018/10/25/Access-restriction-The-type-Unsafe-is-not-API-restriction/" data-id="cjumisv890001qtpv8xuo2s5u" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Access-restriction-The-type-Unsafe-is-not-API-restriction/">Access restriction The type Unsafe is not API (restriction.</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-java-objectsize" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/10/25/java-objectsize/" class="article-date">
  <time datetime="2018-10-24T18:51:11.000Z" itemprop="datePublished">2018-10-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/25/java-objectsize/">java-objectsize</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="One-simple-way-to-get-object-size"><a href="#One-simple-way-to-get-object-size" class="headerlink" title="One simple way to get object size"></a>One simple way to get object size</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.carrotsearch&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;java-sizeof&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;0.0.5&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">System.out.println(RamUsageEstimator.sizeOf(<span class="keyword">new</span> String(<span class="string">"hello world!"</span>)));</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://warrenwx.github.io/2018/10/25/java-objectsize/" data-id="cjumisvk2000jqtpv67z2hsyg" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java-object-size-sizeof/">java object size sizeof</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Volatile" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/10/18/Volatile/" class="article-date">
  <time datetime="2018-10-18T14:37:38.000Z" itemprop="datePublished">2018-10-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/18/Volatile/">volatile</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="what-kind-of-occasion-we-need-to-deal-with"><a href="#what-kind-of-occasion-we-need-to-deal-with" class="headerlink" title="what kind of occasion we need to deal with"></a>what kind of occasion we need to deal with</h3><p>consider code behind.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">A</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">50</span>; i ++) &#123;</span><br><span class="line">			Thread thread = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;							</span><br><span class="line">				<span class="meta">@Override</span></span><br><span class="line">				<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">					<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) &#123;						</span><br><span class="line">						++ number;</span><br><span class="line">						System.out.println(Thread.currentThread().getName() + <span class="string">" get "</span> + number);					</span><br><span class="line">					&#125;											</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;);</span><br><span class="line">			thread.start();</span><br><span class="line">		&#125;</span><br><span class="line">		Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">		System.out.println(<span class="string">"finally "</span> + number);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>finally, the result of ‘number’ is not predictable, which might be 960, 977 or 999.</p>
<h3 id="what-volatile-can-guarantee"><a href="#what-volatile-can-guarantee" class="headerlink" title="what volatile can guarantee"></a>what volatile can guarantee</h3><p>it keeps every thread get ‘global’ variable with consitent value. one more thing, ++number is not atomic, update number in multi-thread is not safe. add synchronized symbol will make it.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">A</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">50</span>; i ++) &#123;</span><br><span class="line">			Thread thread = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;							</span><br><span class="line">				<span class="meta">@Override</span></span><br><span class="line">				<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">					<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) &#123;</span><br><span class="line">						<span class="keyword">synchronized</span> (integerLock) &#123;</span><br><span class="line">							++ number;</span><br><span class="line">							System.out.println(Thread.currentThread().getName() + <span class="string">" get "</span> + number);</span><br><span class="line">						&#125;											</span><br><span class="line">					&#125;											</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;);</span><br><span class="line">			thread.start();</span><br><span class="line">		&#125;</span><br><span class="line">		Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">		System.out.println(<span class="string">"finally "</span> + number);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure></p>
<p>so, synchronized can be a useable way in this occasion. compared to Optimistic Lock, synchronized cost too much, as it is a kind of Pessimistic Lock. </p>
<h3 id="what-volatile-means"><a href="#what-volatile-means" class="headerlink" title="what volatile means"></a>what volatile means</h3><p>n. a volatile substance; a substance that changes readily from solid or liquid to a vapor, which means somthing can be changed at anytime.</p>
<p>As statement ‘lock’ will have bus or cache(cpu level) all to itself(core), which will influence multi-core performance. cas + volatile is a kind of Optimistic Lock, code follows.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ClassName</span>:     CASTest.java</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>:   TODO</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span></span></span><br><span class="line"><span class="comment">         xiang_wang</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span></span></span><br><span class="line"><span class="comment">        V1.0  </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>           2018年10月25日 下午3:13:08 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ExecutorService;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Executors;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sun.misc.Unsafe;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> xiang_wang</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CASTest</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">int</span> value = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> value;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">increaseAndGet</span><span class="params">()</span> <span class="keyword">throws</span> NoSuchFieldException, SecurityException, InterruptedException </span>&#123;</span><br><span class="line">		<span class="keyword">while</span>(<span class="keyword">true</span>) &#123;</span><br><span class="line">			<span class="keyword">int</span> next = value + <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span>(innerCas(value, next)) &#123;</span><br><span class="line">				<span class="keyword">return</span> next;</span><br><span class="line">			&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">				System.out.println(Thread.currentThread().getName() + <span class="string">" wait."</span>);</span><br><span class="line">				Thread.sleep(<span class="number">100</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">innerCas</span><span class="params">(<span class="keyword">int</span> before, <span class="keyword">int</span> after)</span> <span class="keyword">throws</span> NoSuchFieldException, SecurityException </span>&#123;</span><br><span class="line">		Unsafe unsafe = getUnsafe();</span><br><span class="line">		<span class="keyword">return</span> unsafe.compareAndSwapInt(<span class="keyword">this</span>, unsafe.objectFieldOffset(CASTest.class.getDeclaredField(<span class="string">"value"</span>)), before, after);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Unsafe <span class="title">getUnsafe</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Field singletonInstanceField = Unsafe.class.getDeclaredField(<span class="string">"theUnsafe"</span>);</span><br><span class="line">            singletonInstanceField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">            <span class="keyword">return</span> (Unsafe) singletonInstanceField.get(<span class="keyword">null</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@Title</span>:        main </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@Description</span>:  TODO </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span>:        <span class="doctag">@param</span> args    </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span>:       void    </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@author</span>        xiang_wang</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@Date</span>          2018年10月25日 下午3:13:09 </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> SecurityException </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> NoSuchFieldException </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> InterruptedException </span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		CASTest casTest = <span class="keyword">new</span> CASTest();		</span><br><span class="line">		ExecutorService es = Executors.newFixedThreadPool(<span class="number">10</span>);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++ i) &#123;</span><br><span class="line">			es.execute(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">				</span><br><span class="line">				<span class="meta">@Override</span></span><br><span class="line">				<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">					</span><br><span class="line">					<span class="keyword">try</span> &#123;</span><br><span class="line">						<span class="keyword">while</span>(<span class="keyword">true</span>) &#123;</span><br><span class="line">							System.out.println(Thread.currentThread().getName() + <span class="string">":"</span> + casTest.increaseAndGet());</span><br><span class="line">							Thread.sleep(<span class="number">100</span>);</span><br><span class="line">						&#125;					</span><br><span class="line">					&#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">						<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">						e.printStackTrace();</span><br><span class="line">					&#125; <span class="keyword">catch</span> (SecurityException e) &#123;</span><br><span class="line">						<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">						e.printStackTrace();</span><br><span class="line">					&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">						<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">						e.printStackTrace();</span><br><span class="line">					&#125;				</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;);</span><br><span class="line">		&#125;		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Conclusion, the method is reliable. but I am more interested in the parameters in this program. ‘Thread.sleep(100)’ statement may influence program performance, At least that’s what I believed when I wrote the program.<br>let’s test it. In my opinion, the first statement will make increaseAndGet faster and the second will make thread competition more fiercely.</p>
<p>when interval of retry time decrease, and competition between threads, repetition will occur, as value may have been revised by other threads.<br>consider this two statements:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> next = value + <span class="number">1</span>;	<span class="comment">// statement 1</span></span><br><span class="line"><span class="keyword">if</span>(innerCas(value, next)) &#123;	<span class="comment">// statement 2</span></span><br></pre></td></tr></table></figure></p>
<ol>
<li>In thread-1, value is 10, after statement 1, next is 11</li>
<li>In thread-2, value changes from 10 to 11.</li>
<li>In thread-1, statement 2 executes, value = 11, next = 11, uhuhuh</li>
</ol>
<p>fix bug:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> before = value;	<span class="comment">// save value for thread-x</span></span><br><span class="line"><span class="keyword">int</span> next = before + <span class="number">1</span>; <span class="comment">// save update value to thread-x</span></span><br><span class="line"><span class="keyword">if</span>(innerCas(before, next)) &#123;</span><br><span class="line">	<span class="keyword">return</span> next;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">xxx</span><br></pre></td></tr></table></figure></p>
<p>experiment result and analysis:</p>
<table>
<thead>
<tr>
<th>retry/wait</th>
<th>50</th>
<th>100</th>
<th>200</th>
<th>500</th>
<th>1000</th>
</tr>
</thead>
<tbody>
<tr>
<td>50</td>
<td>479/7422</td>
<td>50/10253</td>
<td>22/20074</td>
<td>22/49760</td>
<td>18/99256</td>
</tr>
<tr>
<td>100</td>
<td>60/5609</td>
<td>496/14968</td>
<td>40/20349</td>
<td>13/49951</td>
<td>23/100053</td>
</tr>
<tr>
<td>200</td>
<td>33/5698</td>
<td>103/12056</td>
<td>379/27471</td>
<td>17/50160</td>
<td>28/100057</td>
</tr>
<tr>
<td>500</td>
<td>21/6054</td>
<td>47/12355</td>
<td>18/20849</td>
<td>495/74570</td>
<td>59/102554</td>
</tr>
<tr>
<td>1000</td>
<td>18/6810</td>
<td>18/11759</td>
<td>23/22253</td>
<td>107/60574</td>
<td>591/159076</td>
</tr>
</tbody>
</table>
<p>when wait time is as short as possible, retry time influence conflict time significantly. the lower retry time is, the more times thread try to update ‘value’.<br>when wait time is long enough, the times become reverse related. retry and wait range from 50 to 1000 has no significant effect to total execution time, which is main related to wait time.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://warrenwx.github.io/2018/10/18/Volatile/" data-id="cjumisvk9000mqtpvtkvxy1af" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/volatile-synchronized-java-cas/">volatile, synchronized, java, cas.</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-TCP-Handshake" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/23/TCP-Handshake/" class="article-date">
  <time datetime="2018-08-22T20:42:29.000Z" itemprop="datePublished">2018-08-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/23/TCP-Handshake/">TCP-Handshake</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://thumbnail0.baidupcs.com/thumbnail/e901d2eb06ada2c1d1c1b4be90cfc9cb?fid=643849979-250528-123255577799258&amp;time=1535022000&amp;rt=sh&amp;sign=FDTAER-DCb740ccc5511e5e8fedcff06b081203-sSyTkRex11ejPXrjiWNqvT36R/Y=&amp;expires=8h&amp;chkv=0&amp;chkbd=0&amp;chkpc=&amp;dp-logid=5446060061019588385&amp;dp-callid=0&amp;size=c710_u400&amp;quality=100&amp;vuk=-&amp;ft=video" alt="enter image description here"><br>慢开始算法：当主机开始发送数据时，如果立即所大量数据字节注入到网络，那么就有可能引起网络拥塞，因为现在并不清楚网络的负荷情况。因此，较好的方法是 先探测一下，即由小到大逐渐增大发送窗口，也就是说，由小到大逐渐增大拥塞窗口数值。通常在刚刚开始发送报文段时，先把拥塞窗口 cwnd 设置为一个最大报文段MSS的数值。而在每收到一个对新的报文段的确认后，把拥塞窗口增加至多一个MSS的数值。用这样的方法逐步增大发送方的拥塞窗口 cwnd ，可以使分组注入到网络的速率更加合理。<br>每经过一个传输轮次，拥塞窗口 cwnd 就加倍。一个传输轮次所经历的时间其实就是往返时间RTT。不过“传输轮次”更加强调：把拥塞窗口cwnd所允许发送的报文段都连续发送出去，并收到了对已发送的最后一个字节的确认。<br>另，慢开始的“慢”并不是指cwnd的增长速率慢，而是指在TCP开始发送报文段时先设置cwnd=1，使得发送方在开始时只发送一个报文段（目的是试探一下网络的拥塞情况），然后再逐渐增大cwnd。<br>为了防止拥塞窗口cwnd增长过大引起网络拥塞，还需要设置一个慢开始门限ssthresh状态变量（如何设置ssthresh）。慢开始门限ssthresh的用法如下：<br>当 cwnd &lt; ssthresh 时，使用上述的慢开始算法。<br>当 cwnd &gt; ssthresh 时，停止使用慢开始算法而改用拥塞避免算法。<br>当 cwnd = ssthresh 时，既可使用慢开始算法，也可使用拥塞控制避免算法。<br>拥塞避免算法：让拥塞窗口cwnd缓慢地增大，即每经过一个往返时间RTT就把发送方的拥塞窗口cwnd加1，而不是加倍。这样拥塞窗口cwnd按线性规律缓慢增长，比慢开始算法的拥塞窗口增长速率缓慢得多。</p>
<p>与快重传配合使用的还有快恢复算法，其过程有以下两个要点：</p>
<p><1>. 当发送方连续收到三个重复确认，就执行“乘法减小”算法，把慢开始门限ssthresh减半。这是为了预防网络发生拥塞。请注意：接下去不执行慢开始算法。</1></p>
<p><2>. 由于发送方现在认为网络很可能没有发生拥塞，因此与慢开始不同之处是现在不执行慢开始算法（即拥塞窗口cwnd现在不设置为1），而是把cwnd值设置为 慢开始门限ssthresh减半后的数值，然后开始执行拥塞避免算法（“加法增大”），使拥塞窗口缓慢地线性增大。</2></p>
<p><img src="https://pic002.cnblogs.com/images/2010/125788/2010101123101842.jpg" alt="TCP Conjestion"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://warrenwx.github.io/2018/08/23/TCP-Handshake/" data-id="cjumisvge000gqtpvwj2gjrcm" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Sunday-Method-Pattern-Match" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/23/Sunday-Method-Pattern-Match/" class="article-date">
  <time datetime="2018-08-22T20:42:21.000Z" itemprop="datePublished">2018-08-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/23/Sunday-Method-Pattern-Match/">Sunday-Method-Pattern-Match</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>###Substr finding algorithm : Sunday</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">int</span> <span class="title">sunday</span><span class="params">(<span class="keyword">char</span> SArrary[], <span class="keyword">int</span> iSLen, <span class="keyword">char</span> TArrary[], <span class="keyword">int</span> iTLen)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, pos = <span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">while</span> (i &lt; iSLen)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (SArrary[i] == TArrary[j])</span><br><span class="line">		&#123;</span><br><span class="line">			++i;</span><br><span class="line">			++j;</span><br><span class="line">			<span class="keyword">if</span> (j == iTLen - <span class="number">1</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				pos = i - j;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// 下一个需要比较的字符串位置next</span></span><br><span class="line">			<span class="keyword">int</span> next = iTLen - j + i;</span><br><span class="line">			<span class="keyword">int</span> k = iTLen - <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span> (; k &gt;= <span class="number">0</span>; --k)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span> (SArrary[next] == TArrary[k])</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//找到对应的字符</span></span><br><span class="line">			<span class="keyword">if</span> (k &gt;= <span class="number">0</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="comment">// i的新下标位置</span></span><br><span class="line">				i = next - k;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				++i;</span><br><span class="line">			&#125;</span><br><span class="line">			j = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> pos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://warrenwx.github.io/2018/08/23/Sunday-Method-Pattern-Match/" data-id="cjumisvgc000fqtpv0heh5vms" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Process-communication" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/23/Process-communication/" class="article-date">
  <time datetime="2018-08-22T20:42:15.000Z" itemprop="datePublished">2018-08-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/23/Process-communication/">Process-communication</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://docs.oracle.com/cd/E38902_01/html/E38880/svipc-38596.html" target="_blank" rel="noopener">Process_Communication</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://warrenwx.github.io/2018/08/23/Process-communication/" data-id="cjumisveq000dqtpvynqmwmbk" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Access-restriction-The-type-Unsafe-is-not-API-restriction/">Access restriction The type Unsafe is not API (restriction.</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ios11-ppt-open/">ios11, ppt, open.</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java-object-size-sizeof/">java object size sizeof</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/volatile-synchronized-java-cas/">volatile, synchronized, java, cas.</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Access-restriction-The-type-Unsafe-is-not-API-restriction/" style="font-size: 10px;">Access restriction The type Unsafe is not API (restriction.</a> <a href="/tags/ios11-ppt-open/" style="font-size: 10px;">ios11, ppt, open.</a> <a href="/tags/java-object-size-sizeof/" style="font-size: 10px;">java object size sizeof</a> <a href="/tags/volatile-synchronized-java-cas/" style="font-size: 10px;">volatile, synchronized, java, cas.</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/04/19/The-Essence-of-Life/">The Essence of Life</a>
          </li>
        
          <li>
            <a href="/2019/04/01/Nginx-luajit-memory-crash-mmap-wrapper/">Nginx luajit memory crash mmap_wrapper</a>
          </li>
        
          <li>
            <a href="/2018/11/03/Linux-Mem-High-Go-Trouble-Shooting/">Linux-Mem-High-Go-Trouble-Shooting</a>
          </li>
        
          <li>
            <a href="/2018/10/31/ios11-ppt/">ios11-ppt</a>
          </li>
        
          <li>
            <a href="/2018/10/25/Access-restriction-The-type-Unsafe-is-not-API-restriction/">Access restriction: The type Unsafe is not API (restriction</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 warrenwx/warrenwx<br>     
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>